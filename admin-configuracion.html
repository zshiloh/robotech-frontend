<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Configuración del Sistema - ROBOTECH</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="css/styles.css" />
    <style>
        :root {
            --admin-gradient: linear-gradient(135deg, #e91e63 0%, #c2185b 100%);
            --admin-color: #e91e63;
            --admin-dark: #c2185b;
            --sidebar-width: 280px;
            --navbar-height: 70px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        /* NAVBAR MODERNA */
        .navbar-modern {
            background: white;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            height: var(--navbar-height);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 0 2rem;
        }

        .navbar-brand-modern {
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
        }

        .navbar-brand-modern .logo-circle {
            width: 45px;
            height: 45px;
            background: var(--admin-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
        }

        .navbar-brand-modern .logo-circle i {
            color: white;
            font-size: 1.5rem;
        }

        .navbar-brand-modern .brand-text {
            font-size: 1.5rem;
            font-weight: 900;
            background: var(--admin-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 0.5px;
        }

        .navbar-actions {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .notification-btn {
            position: relative;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .notification-btn:hover {
            background: var(--admin-color);
            transform: translateY(-2px);
        }

        .notification-btn:hover i {
            color: white;
        }

        .notification-btn i {
            color: #6c757d;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--admin-gradient);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 0.2rem 0.4rem;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: #f8f9fa;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .user-menu:hover {
            background: var(--admin-color);
        }

        .user-menu:hover .user-name,
        .user-menu:hover i {
            color: white;
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 10px;
            background: var(--admin-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
        }

        .user-name {
            font-weight: 600;
            color: #2d3748;
            transition: all 0.3s;
        }

        .dropdown-menu {
            min-width: 280px;
            border: none;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border-radius: 16px;
            margin-top: 0.75rem !important;
            padding: 0.5rem;
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.15s ease, transform 0.15s ease;
            pointer-events: none;
        }

        .dropdown-menu-end {
            right: 0 !important;
            left: auto !important;
        }

        .dropdown-menu.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .dropdown-item {
            transition: all 0.3s;
        }

        .dropdown-item:hover {
            background: linear-gradient(135deg, rgba(233, 30, 99, 0.1), rgba(194, 24, 91, 0.1));
        }

        .dropdown-item.text-danger:hover {
            background: rgba(244, 67, 54, 0.1);
        }

        .notifications-dropdown {
            width: 400px !important;
            max-height: 500px;
            overflow-y: auto;
            right: 0 !important;
            left: auto !important;
            transform-origin: top right !important;
        }

        .notifications-header {
            padding: 1rem;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notifications-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: #2d3748;
        }

        .notification-item {
            padding: 1rem;
            border-bottom: 1px solid #f0f0f0;
            transition: all 0.3s;
            cursor: pointer;
        }

        .notification-item:hover {
            background: rgba(233, 30, 99, 0.05);
        }

        .notification-item.unread {
            background: rgba(233, 30, 99, 0.05);
            border-left: 3px solid #e91e63;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--admin-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .notification-content {
            flex: 1;
            min-width: 0;
        }

        .notification-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .notification-message {
            font-size: 0.8rem;
            color: #718096;
            margin-bottom: 0.25rem;
            line-height: 1.4;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .notification-time {
            font-size: 0.7rem;
            color: #718096;
        }

        .notification-badge-new {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            font-size: 0.65rem;
            font-weight: 700;
            padding: 0.15rem 0.4rem;
            border-radius: 6px;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .notifications-footer {
            padding: 0.75rem 1rem;
            text-align: center;
            border-top: 2px solid #f0f0f0;
        }

        .notifications-footer a {
            color: #e91e63;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
        }

        .notifications-footer a:hover {
            color: #c2185b;
        }

        .empty-notifications {
            padding: 3rem 2rem;
            text-align: center;
            color: #718096;
        }

        .empty-notifications i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        /* SIDEBAR MODERNA */
        .sidebar-modern {
            position: fixed;
            top: var(--navbar-height);
            left: 0;
            height: calc(100vh - var(--navbar-height));
            width: var(--sidebar-width);
            background: white;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.06);
            padding: 2rem 0;
            overflow-y: auto;
            z-index: 999;
        }

        .sidebar-header-modern {
            padding: 0 1.5rem 1.5rem;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 1.5rem;
        }

        .sidebar-header-modern h5 {
            font-size: 0.85rem;
            font-weight: 700;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sidebar-menu-modern {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar-menu-modern li {
            padding: 0 1rem;
            margin-bottom: 0.5rem;
        }

        .sidebar-menu-modern li a {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.25rem;
            border-radius: 12px;
            text-decoration: none;
            color: #6c757d;
            font-weight: 600;
            transition: all 0.3s;
            position: relative;
        }

        .sidebar-menu-modern li a i {
            width: 24px;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .sidebar-menu-modern li a:hover {
            background: linear-gradient(135deg, rgba(233, 30, 99, 0.1) 0%, rgba(194, 24, 91, 0.1) 100%);
            color: var(--admin-color);
            transform: translateX(5px);
        }

        .sidebar-menu-modern li a.active {
            background: var(--admin-gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
        }

        .sidebar-menu-modern li a.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 60%;
            background: white;
            border-radius: 0 4px 4px 0;
        }

        /* MAIN CONTENT */
        .main-content-modern {
            margin-left: var(--sidebar-width);
            margin-top: var(--navbar-height);
            padding: 2.5rem;
            min-height: calc(100vh - var(--navbar-height));
        }

        .config-hero {
            background: var(--admin-gradient);
            border-radius: 20px;
            padding: 2.5rem;
            color: white;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(233, 30, 99, 0.3);
            position: relative;
            overflow: hidden;
            animation: slideDown 0.6s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .config-hero::before {
            content: "\f013";
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            position: absolute;
            font-size: 12rem;
            opacity: 0.08;
            right: -2rem;
            top: 50%;
            transform: translateY(-50%);
            animation: float 8s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(-50%) rotate(-15deg);
            }

            50% {
                transform: translateY(-55%) rotate(-10deg);
            }
        }

        .config-hero h1 {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .config-hero p {
            font-size: 1.1rem;
            opacity: 0.95;
            margin: 0;
            position: relative;
            z-index: 1;
        }

        .config-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            border-top: 5px solid #e91e63;
            animation: fadeInUp 0.5s ease both;
        }

        .config-section:nth-child(2) {
            animation-delay: 0.1s;
        }

        .config-section:nth-child(3) {
            animation-delay: 0.2s;
        }

        .config-section:nth-child(4) {
            animation-delay: 0.3s;
        }

        .config-section:nth-child(5) {
            animation-delay: 0.4s;
        }

        .config-section:nth-child(6) {
            animation-delay: 0.5s;
        }

        .config-section:nth-child(7) {
            animation-delay: 0.6s;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .config-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid #f0f0f0;
        }

        .config-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            background: var(--admin-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            flex-shrink: 0;
            box-shadow: 0 6px 15px rgba(233, 30, 99, 0.4);
        }

        .config-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin: 0;
        }

        .config-subtitle {
            color: #6c757d;
            font-size: 0.875rem;
            margin: 0;
        }

        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .config-item {
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #e91e63;
            transition: all 0.3s ease;
        }

        .config-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .config-item-label {
            font-weight: 600;
            color: #2d3748;
            font-size: 1.1rem;
        }

        .config-item-value {
            font-size: 2rem;
            font-weight: 700;
            color: #e91e63;
            margin-bottom: 0.5rem;
        }

        .config-item-description {
            color: #6c757d;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .form-group-config {
            margin-bottom: 1.5rem;
        }

        .form-label-config {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.75rem;
            display: block;
            font-size: 1rem;
        }

        .form-control-config {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control-config:focus {
            outline: none;
            border-color: #e91e63;
            box-shadow: 0 0 0 3px rgba(233, 30, 99, 0.1);
        }

        .form-control-config:disabled {
            background: #e9ecef;
            cursor: not-allowed;
        }

        .switch-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .switch-label {
            font-weight: 600;
            color: #2d3748;
            margin: 0;
        }

        .switch-description {
            color: #6c757d;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .form-switch {
            min-height: auto;
        }

        .form-check-input {
            width: 60px;
            height: 30px;
            cursor: pointer;
        }

        .form-check-input:checked {
            background-color: #e91e63;
            border-color: #e91e63;
        }

        .btn-save-config {
            background: var(--admin-gradient);
            color: white;
            padding: 1rem 2.5rem;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1.1rem;
            border: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
            width: 100%;
            margin-top: 1rem;
        }

        .btn-save-config:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(233, 30, 99, 0.4);
            color: white;
        }

        .danger-zone {
            border: 3px solid #f44336;
            background: linear-gradient(135deg,
                    rgba(244, 67, 54, 0.05) 0%,
                    transparent 100%);
        }

        .danger-zone .config-header {
            border-bottom-color: #f44336;
        }

        .danger-zone .config-icon {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            box-shadow: 0 6px 15px rgba(244, 67, 54, 0.4);
        }

        .btn-danger-action {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 10px;
            font-weight: 600;
            border: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.3);
        }

        .btn-danger-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.4);
            color: white;
        }

        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 4px solid #2196f3;
            border-radius: 10px;
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
        }

        .info-box i {
            color: #2196f3;
            margin-right: 0.75rem;
            font-size: 1.2rem;
        }

        .success-box {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-left: 4px solid #4caf50;
            border-radius: 10px;
            padding: 1rem 1.5rem;
            margin-top: 1rem;
            display: none;
        }

        .success-box i {
            color: #4caf50;
            margin-right: 0.75rem;
            font-size: 1.2rem;
        }

        .log-container {
            background: #212529;
            color: #00ff00;
            padding: 1.5rem;
            border-radius: 10px;
            font-family: "Courier New", monospace;
            font-size: 0.875rem;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 1rem;
        }

        .log-line {
            margin-bottom: 0.5rem;
        }

        .log-line .timestamp {
            color: #888;
            margin-right: 1rem;
        }

        .log-line .level-info {
            color: #00bcd4;
        }

        .log-line .level-warning {
            color: #ffc107;
        }

        .log-line .level-error {
            color: #f44336;
        }

        @media (max-width: 768px) {
            .sidebar-modern {
                transform: translateX(-100%);
            }

            .sidebar-modern.show {
                transform: translateX(0);
            }

            .main-content-modern {
                margin-left: 0;
                padding: 1.5rem;
            }

            .config-hero {
                padding: 2rem;
            }

            .config-hero h1 {
                font-size: 2rem;
            }

            .notifications-dropdown {
                width: 320px !important;
            }
        }

        @media (max-width: 576px) {
            .notifications-dropdown {
                width: 280px !important;
            }
        }
    </style>
</head>

<body>
    <!-- Navbar Moderna -->
    <nav class="navbar-modern">
        <div class="container-fluid d-flex justify-content-between align-items-center h-100">
            <a href="index.html" class="navbar-brand-modern">
                <div class="logo-circle">
                    <i class="fas fa-robot"></i>
                </div>
                <span class="brand-text">ROBOTECH</span>
            </a>

            <div class="navbar-actions">
                <div class="dropdown">
                    <button class="notification-btn" id="notificacionesBtn" data-bs-toggle="dropdown"
                        data-bs-display="static" aria-expanded="false">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notificacionesBadge" style="display: none;">0</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end notifications-dropdown" id="notificacionesDropdownMenu">
                        <li class="dropdown-item-text text-center py-3">
                            <div class="spinner-border spinner-border-sm"></div>
                        </li>
                    </ul>
                </div>

                <div class="dropdown">
                    <div class="user-menu" data-bs-toggle="dropdown" data-bs-display="static" aria-expanded="false">
                        <div class="user-avatar">
                            <i class="fas fa-user-shield"></i>
                        </div>
                        <span class="user-name" id="usuarioNombre">Admin</span>
                        <i class="fas fa-chevron-down" style="color: #6c757d; font-size: 0.8rem;"></i>
                    </div>
                    <ul class="dropdown-menu dropdown-menu-end shadow-lg"
                        style="min-width: 250px; border-radius: 16px; border: none; padding: 0.5rem;">
                        <li class="px-3 py-2" style="border-bottom: 2px solid #f0f0f0;">
                            <div class="d-flex align-items-center gap-2 mb-2">
                                <div class="user-avatar" style="width: 40px; height: 40px;">
                                    <i class="fas fa-user-shield"></i>
                                </div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 700; color: #2d3748; font-size: 0.95rem;"
                                        id="usuarioNombreMenu">Admin</div>
                                    <div style="font-size: 0.8rem; color: #6c757d;" id="emailUsuarioNav">
                                        admin@robotech.com</div>
                                </div>
                            </div>
                        </li>
                        <li class="mt-2">
                            <a class="dropdown-item d-flex align-items-center gap-2" href="usuario-perfil.html"
                                style="border-radius: 10px; padding: 0.75rem 1rem; font-weight: 600;">
                                <i class="fas fa-user-edit"></i>
                                <span>Mi Perfil</span>
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item text-danger d-flex align-items-center gap-2" href="#"
                                onclick="logout()"
                                style="border-radius: 10px; padding: 0.75rem 1rem; font-weight: 600;">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Cerrar Sesión</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <!-- Sidebar Moderna -->
    <aside class="sidebar-modern">
        <div class="sidebar-header-modern">
            <h5><i class="fas fa-user-shield"></i> Panel de Control</h5>
        </div>
        <ul class="sidebar-menu-modern">
            <li><a href="admin-dashboard.html"><i class="fas fa-home"></i> <span>Dashboard</span></a></li>
            <li><a href="admin-usuarios.html"><i class="fas fa-users"></i> <span>Usuarios</span></a></li>
            <li><a href="admin-clubes.html"><i class="fas fa-shield-alt"></i> <span>Clubes</span></a></li>
            <li><a href="admin-torneos.html"><i class="fas fa-trophy"></i> <span>Torneos</span></a></li>
            <li><a href="admin-configuracion.html" class="active"><i class="fas fa-cog"></i>
                    <span>Configuración</span></a></li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content-modern">
        <div class="container-fluid">
            <div class="config-hero">
                <h1><i class="fas fa-cog"></i> Configuración del Sistema</h1>
                <p>Administra los parámetros globales de ROBOTECH</p>
            </div>
            <div class="config-section">
                <div class="config-header">
                    <div class="config-icon"><i class="fas fa-chart-line"></i></div>
                    <div>
                        <div class="config-title">Estadísticas del Sistema</div>
                        <div class="config-subtitle">Información general del sistema</div>
                    </div>
                </div>
                <div class="config-grid">
                    <div class="config-item">
                        <div class="config-item-label">Versión del Sistema</div>
                        <div class="config-item-value" id="version">v1.0.0</div>
                        <div class="config-item-description">
                            Versión actual de ROBOTECH
                        </div>
                    </div>
                    <div class="config-item">
                        <div class="config-item-label">Base de Datos</div>
                        <div class="config-item-value">
                            <i class="fas fa-check-circle text-success"></i>
                        </div>
                        <div class="config-item-description">Conexión establecida</div>
                    </div>
                    <div class="config-item">
                        <div class="config-item-label">Tiempo de Actividad</div>
                        <div class="config-item-value" id="uptime">--</div>
                        <div class="config-item-description">Sistema operativo</div>
                    </div>
                </div>
            </div>
            <div class="config-section">
                <div class="config-header">
                    <div class="config-icon"><i class="fas fa-sliders-h"></i></div>
                    <div>
                        <div class="config-title">Parámetros Generales</div>
                        <div class="config-subtitle">
                            Configuración de reglas del sistema
                        </div>
                    </div>
                </div>
                <form id="formConfiguracion">
                    <div class="form-group-config">
                        <label class="form-label-config">Máximo de Clubes por Representante</label><input type="number"
                            class="form-control-config" id="maxClubes" min="1" max="10" value="3" /><small
                            class="text-muted">Número máximo de clubes que puede gestionar un
                            representante</small>
                    </div>
                    <div class="form-group-config">
                        <label class="form-label-config">Máximo de Robots por Club</label><input type="number"
                            class="form-control-config" id="maxRobots" min="1" max="100" value="20" /><small
                            class="text-muted">Número máximo de robots que puede tener un club</small>
                    </div>
                    <div class="form-group-config">
                        <label class="form-label-config">Límite de Cambios de Club (Trimestral)</label><input
                            type="number" class="form-control-config" id="maxCambios" min="0" max="5" value="1" /><small
                            class="text-muted">Veces que un competidor puede cambiar de club por
                            trimestre</small>
                    </div>
                    <div class="form-group-config">
                        <label class="form-label-config">Días de Inactividad antes de Marcar</label><input type="number"
                            class="form-control-config" id="diasInactividad" min="30" max="365" value="90" /><small
                            class="text-muted">Días sin actividad antes de marcar como inactivo</small>
                    </div>
                    <button type="button" class="btn btn-save-config" onclick="guardarConfiguracion()">
                        <i class="fas fa-save"></i> Guardar Configuración
                    </button>
                </form>
                <div class="success-box" id="successMessage">
                    <i class="fas fa-check-circle"></i> Configuración guardada
                    exitosamente
                </div>
            </div>
            <div class="config-section">
                <div class="config-header">
                    <div class="config-icon"><i class="fas fa-toggle-on"></i></div>
                    <div>
                        <div class="config-title">Funcionalidades del Sistema</div>
                        <div class="config-subtitle">
                            Habilitar o deshabilitar características
                        </div>
                    </div>
                </div>
                <div class="switch-container">
                    <div>
                        <div class="switch-label">Registro de Nuevos Usuarios</div>
                        <div class="switch-description">
                            Permitir que nuevos usuarios se registren en el sistema
                        </div>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="switchRegistro" checked />
                    </div>
                </div>
                <div class="switch-container">
                    <div>
                        <div class="switch-label">Notificaciones Email</div>
                        <div class="switch-description">
                            Enviar notificaciones por correo electrónico
                        </div>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="switchEmail" checked />
                    </div>
                </div>
                <div class="switch-container">
                    <div>
                        <div class="switch-label">Validación Automática de Clubes</div>
                        <div class="switch-description">
                            Aprobar clubes automáticamente sin revisión manual
                        </div>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="switchValidacion" />
                    </div>
                </div>
                <div class="switch-container">
                    <div>
                        <div class="switch-label">Modo Mantenimiento</div>
                        <div class="switch-description">
                            Deshabilitar acceso al sistema para usuarios no-admin
                        </div>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="switchMantenimiento" />
                    </div>
                </div>
            </div>
            <div class="config-section">
                <div class="config-header">
                    <div class="config-icon"><i class="fas fa-database"></i></div>
                    <div>
                        <div class="config-title">Backup y Respaldo</div>
                        <div class="config-subtitle">Gestión de copias de seguridad</div>
                    </div>
                </div>
                <div class="info-box">
                    <i class="fas fa-info-circle"></i> Las copias de seguridad se
                    realizan automáticamente cada noche a las 2:00 AM
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <button class="btn btn-primary w-100" onclick="crearBackup()">
                            <i class="fas fa-download"></i> Crear Backup Manual
                        </button>
                    </div>
                    <div class="col-md-6 mb-3">
                        <button class="btn btn-secondary w-100" onclick="restaurarBackup()">
                            <i class="fas fa-upload"></i> Restaurar desde Backup
                        </button>
                    </div>
                </div>
                <div class="form-group-config">
                    <label class="form-label-config">Último Backup Realizado</label><input type="text"
                        class="form-control-config" id="ultimoBackup" value="17 Diciembre 2024, 02:00 AM" disabled />
                </div>
            </div>
            <div class="config-section">
                <div class="config-header">
                    <div class="config-icon"><i class="fas fa-file-alt"></i></div>
                    <div>
                        <div class="config-title">Logs del Sistema</div>
                        <div class="config-subtitle">Registro de eventos y errores</div>
                    </div>
                </div>
                <button class="btn btn-outline-primary mb-3" onclick="cargarLogs()">
                    <i class="fas fa-sync"></i> Actualizar Logs
                </button>
                <div class="log-container" id="logContainer">
                    <div class="log-line">
                        <span class="timestamp">[2024-12-17 14:30:15]</span><span class="level-info">[INFO]</span>
                        Sistema iniciado
                        correctamente
                    </div>
                    <div class="log-line">
                        <span class="timestamp">[2024-12-17 14:30:20]</span><span class="level-info">[INFO]</span>
                        Usuario admin inició
                        sesión
                    </div>
                    <div class="log-line">
                        <span class="timestamp">[2024-12-17 14:31:45]</span><span class="level-info">[INFO]</span> Nuevo
                        club registrado:
                        Club Alpha
                    </div>
                    <div class="log-line">
                        <span class="timestamp">[2024-12-17 14:32:10]</span><span class="level-warning">[WARNING]</span>
                        Intento de acceso
                        denegado - IP: 192.168.1.100
                    </div>
                    <div class="log-line">
                        <span class="timestamp">[2024-12-17 14:35:22]</span><span class="level-info">[INFO]</span>
                        Torneo creado: Nacional
                        2025
                    </div>
                </div>
            </div>
            <div class="config-section danger-zone">
                <div class="config-header">
                    <div class="config-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div>
                        <div class="config-title">Zona de Peligro</div>
                        <div class="config-subtitle">
                            Acciones irreversibles - Usar con precaución
                        </div>
                    </div>
                </div>
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle"></i>
                    <strong>¡Advertencia!</strong> Las acciones en esta sección son
                    permanentes y no se pueden deshacer.
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <button class="btn btn-danger-action w-100" onclick="limpiarNotificaciones()">
                            <i class="fas fa-bell-slash"></i> Limpiar Todas las
                            Notificaciones
                        </button>
                    </div>
                    <div class="col-md-6">
                        <button class="btn btn-danger-action w-100" onclick="resetearEstadisticas()">
                            <i class="fas fa-chart-line"></i> Resetear Estadísticas
                        </button>
                    </div>
                    <div class="col-md-6">
                        <button class="btn btn-danger-action w-100" onclick="limpiarLogs()">
                            <i class="fas fa-trash"></i> Limpiar Logs del Sistema
                        </button>
                    </div>
                    <div class="col-md-6">
                        <button class="btn btn-danger-action w-100" onclick="resetearSistema()">
                            <i class="fas fa-redo"></i> Resetear Sistema Completo
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/constants.js"></script>
    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/notificaciones.js"></script>
    <script>
        protectPage(NOMBRES_ROLES.ADMINISTRADOR);
        document.addEventListener("DOMContentLoaded", () => {
            const usuario = getCurrentUser();
            const nombreCompleto = usuario.nombreCompleto || 'Administrador';
            const email = usuario.email || '';
            document.getElementById("usuarioNombre").textContent = nombreCompleto;
            document.getElementById("usuarioNombreMenu").textContent = nombreCompleto;
            document.getElementById("emailUsuarioNav").textContent = email;
            cargarConfiguracion();
            actualizarUptime();
            cargarNotificaciones();
            setInterval(cargarNotificaciones, 30000);
        });
        async function cargarConfiguracion() {
            try {
                const result = await fetchAPI("/api/admin/configuracion", "GET");
                if (result.success && result.data) {
                    const config = result.data;
                    document.getElementById("maxClubes").value =
                        config.maxClubesPorRepresentante || 3;
                    document.getElementById("maxRobots").value =
                        config.maxRobotsPorClub || 20;
                    document.getElementById("maxCambios").value =
                        config.maxCambiosClubTrimestral || 1;
                    document.getElementById("diasInactividad").value =
                        config.diasInactividad || 90;
                    document.getElementById("switchRegistro").checked =
                        config.registroAbierto !== false;
                    document.getElementById("switchEmail").checked =
                        config.notificacionesEmail !== false;
                    document.getElementById("switchValidacion").checked =
                        config.validacionAutomatica === true;
                    document.getElementById("switchMantenimiento").checked =
                        config.modoMantenimiento === true;
                    if (config.version)
                        document.getElementById("version").textContent = config.version;
                    if (config.ultimoBackup)
                        document.getElementById("ultimoBackup").value =
                            formatearFechaCompleta(config.ultimoBackup);
                }
            } catch (error) {
                console.error("Error:", error);
            }
        }
        async function guardarConfiguracion() {
            const config = {
                maxClubesPorRepresentante: parseInt(
                    document.getElementById("maxClubes").value
                ),
                maxRobotsPorClub: parseInt(
                    document.getElementById("maxRobots").value
                ),
                maxCambiosClubTrimestral: parseInt(
                    document.getElementById("maxCambios").value
                ),
                diasInactividad: parseInt(
                    document.getElementById("diasInactividad").value
                ),
                registroAbierto: document.getElementById("switchRegistro").checked,
                notificacionesEmail: document.getElementById("switchEmail").checked,
                validacionAutomatica:
                    document.getElementById("switchValidacion").checked,
                modoMantenimiento: document.getElementById("switchMantenimiento")
                    .checked,
            };
            mostrarLoading();
            try {
                const result = await fetchAPI(
                    "/api/admin/configuracion",
                    "PUT",
                    config
                );
                ocultarLoading();
                if (result.success) {
                    const successBox = document.getElementById("successMessage");
                    successBox.style.display = "block";
                    setTimeout(() => {
                        successBox.style.display = "none";
                    }, 3000);
                } else {
                    mostrarAlerta(result.data?.message || "Error al guardar", "error");
                }
            } catch (error) {
                ocultarLoading();
                mostrarAlerta("Error de conexión", "error");
            }
        }
        function actualizarUptime() {
            const start = new Date("2024-12-01T00:00:00");
            const now = new Date();
            const diff = Math.floor((now - start) / (1000 * 60 * 60 * 24));
            document.getElementById("uptime").textContent = `${diff} días`;
            setInterval(() => {
                const now = new Date();
                const diff = Math.floor((now - start) / (1000 * 60 * 60 * 24));
                document.getElementById("uptime").textContent = `${diff} días`;
            }, 60000);
        }
        async function crearBackup() {
            if (!confirmar("¿Crear backup manual del sistema?")) return;
            mostrarLoading();
            try {
                const result = await fetchAPI("/api/admin/backup", "POST");
                ocultarLoading();
                if (result.success) {
                    mostrarAlerta("Backup creado exitosamente", "success");
                    await cargarConfiguracion();
                } else {
                    mostrarAlerta(result.data?.message || "Error", "error");
                }
            } catch (error) {
                ocultarLoading();
                mostrarAlerta("Error de conexión", "error");
            }
        }
        function restaurarBackup() {
            const file = prompt("Ingrese el nombre del archivo de backup:");
            if (!file) return;
            if (
                !confirmar(
                    "¿Restaurar desde backup? Esta acción reemplazará los datos actuales."
                )
            )
                return;
            mostrarLoading();
            setTimeout(() => {
                ocultarLoading();
                mostrarAlerta("Función de restauración en desarrollo", "info");
            }, 1000);
        }
        async function cargarLogs() {
            const container = document.getElementById("logContainer");
            container.innerHTML =
                '<div class="text-center"><div class="spinner-border text-light"></div></div>';
            try {
                const result = await fetchAPI("/api/admin/logs", "GET");
                if (result.success && result.data && result.data.length > 0) {
                    let html = "";
                    result.data.forEach((log) => {
                        const levelClass =
                            log.level === "ERROR"
                                ? "level-error"
                                : log.level === "WARNING"
                                    ? "level-warning"
                                    : "level-info";
                        html += `<div class="log-line"><span class="timestamp">[${log.timestamp
                            }]</span><span class="${levelClass}">[${log.level
                            }]</span> ${escaparHTML(log.message)}</div>`;
                    });
                    container.innerHTML = html;
                } else {
                    container.innerHTML =
                        '<div class="text-center text-muted">No hay logs disponibles</div>';
                }
            } catch (error) {
                container.innerHTML =
                    '<div class="text-danger">Error al cargar logs</div>';
            }
        }
        async function limpiarNotificaciones() {
            if (
                !confirmar(
                    "¿Eliminar TODAS las notificaciones del sistema? Esta acción no se puede deshacer."
                )
            )
                return;
            mostrarLoading();
            try {
                const result = await fetchAPI("/api/admin/notificaciones", "DELETE");
                ocultarLoading();
                if (result.success) {
                    mostrarAlerta("Notificaciones eliminadas", "success");
                } else {
                    mostrarAlerta(result.data?.message || "Error", "error");
                }
            } catch (error) {
                ocultarLoading();
                mostrarAlerta("Error de conexión", "error");
            }
        }
        function resetearEstadisticas() {
            if (
                !confirmar(
                    "¿Resetear todas las estadísticas? Los datos se perderán permanentemente."
                )
            )
                return;
            mostrarAlerta("Función en desarrollo", "info");
        }
        function limpiarLogs() {
            if (!confirmar("¿Eliminar todos los logs del sistema?")) return;
            document.getElementById("logContainer").innerHTML =
                '<div class="text-center text-muted">Logs eliminados</div>';
            mostrarAlerta("Logs eliminados", "success");
        }
        function resetearSistema() {
            const confirmacion = prompt(
                'Esta acción eliminará TODOS los datos. Escribe "CONFIRMAR" para continuar:'
            );
            if (confirmacion !== "CONFIRMAR") return;
            if (
                !confirmar(
                    "¿Estás ABSOLUTAMENTE seguro? Esta acción es IRREVERSIBLE."
                )
            )
                return;
            mostrarAlerta(
                "Función de reseteo deshabilitada por seguridad",
                "warning"
            );
        }

        // FUNCIONES DE NOTIFICACIONES
        async function cargarNotificaciones() {
            try {
                const result = await obtenerNotificaciones();
                if (result.success && result.data) {
                    renderizarNotificaciones(result.data);
                }
            } catch (error) {
                console.error('Error cargando notificaciones:', error);
            }
        }

        function renderizarNotificaciones(notificaciones) {
            const badge = document.getElementById('notificacionesBadge');
            const menu = document.getElementById('notificacionesDropdownMenu');
            const noLeidas = notificaciones.filter(n => !n.leido).length;
            if (noLeidas > 0) {
                badge.textContent = noLeidas;
                badge.style.display = 'inline-block';
            } else {
                badge.style.display = 'none';
            }
            if (!notificaciones || notificaciones.length === 0) {
                menu.innerHTML = `
          <li class="empty-notifications">
            <i class="fas fa-bell-slash"></i>
            <p class="mb-0">No tienes notificaciones</p>
          </li>
        `;
                return;
            }
            let html = `
        <li class="notifications-header">
          <span class="notifications-title">Notificaciones</span>
          <span style="color: #718096; font-size: 0.9rem;">${notificaciones.length}</span>
        </li>
      `;
            notificaciones.slice(0, 5).forEach(notif => {
                const iconClass = notif.leido ? '' : 'unread';
                html += `
          <li class="notification-item ${iconClass}" onclick="marcarComoLeida(${notif.id})">
            <div class="d-flex gap-2 align-items-start">
              <div class="notification-icon flex-shrink-0">
                <i class="fas fa-${notif.tipo === 'INFO' ? 'info-circle' : notif.tipo === 'EXITO' ? 'check-circle' : 'exclamation-triangle'}"></i>
              </div>
              <div class="notification-content flex-grow-1" style="min-width: 0;">
                <div class="d-flex justify-content-between align-items-center gap-2 mb-1">
                  <div class="notification-title" style="flex: 1; min-width: 0;">${escaparHTML(notif.titulo)}</div>
                  ${!notif.leido ? '<span class="notification-badge-new flex-shrink-0">Nueva</span>' : ''}
                </div>
                <div class="notification-message">${escaparHTML(notif.mensaje)}</div>
                <div class="notification-time">
                  <i class="fas fa-clock me-1"></i>${formatearFechaRelativa(notif.fechaCreacion)}
                </div>
              </div>
            </div>
          </li>
        `;
            });
            html += `
        <li class="notifications-footer">
          <a href="notificaciones.html">
            <i class="fas fa-bell me-2"></i>Ver todas las notificaciones
          </a>
        </li>
      `;
            menu.innerHTML = html;
        }

        async function marcarComoLeida(notificacionId) {
            try {
                await marcarNotificacionComoLeida(notificacionId);
                cargarNotificaciones();
            } catch (error) {
                console.error('Error:', error);
            }
        }

        function escaparHTML(texto) {
            const div = document.createElement('div');
            div.textContent = texto;
            return div.innerHTML;
        }

        function formatearFechaRelativa(fecha) {
            if (!fecha) return 'Ahora';
            const ahora = new Date();
            const fechaObj = new Date(fecha);
            const diff = Math.floor((ahora - fechaObj) / 1000);
            if (diff < 60) return 'Hace un momento';
            if (diff < 3600) return `Hace ${Math.floor(diff / 60)} min`;
            if (diff < 86400) return `Hace ${Math.floor(diff / 3600)} h`;
            if (diff < 604800) return `Hace ${Math.floor(diff / 86400)} días`;
            return fechaObj.toLocaleDateString();
        }
    </script>
</body>

</html>